<!DOCTYPE html>
<html>
   	<head>
		<title>PM2.5 Visualization | Home</title>
    	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    	<!-- Bootstrap -->
    	<link href="/bootstrap.min.css" rel="stylesheet" media="screen">
		<link href="/main.css" rel="stylesheet" />
		<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.css" /> 
		<!-- <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4.4/leaflet.css" /> -->
 		<!--[if lte IE 8]>
     		<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.ie.css" />
 		<![endif]-->
 		
 		<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
		<script src="http://code.jquery.com/jquery-migrate-1.1.1.min.js"></script>
		<!--<script src="http://cdn.leafletjs.com/leaflet-0.5.1/leaflet.js"></script> -->
		<script src="http://cdn.leafletjs.com/leaflet-0.4.4/leaflet-src.js"></script>
		<script type="text/javascript" src="/QuadTree.js"></script>
 		<script type="text/javascript" src="/heatmap.js"></script>
        <script type="text/javascript" src="/heatmap-leaflet.js"></script>
 		
 		
	</head>
	<body>
		<div class="container">
			<div class="navbar">
				<div class="navbar-inner">
					<ul class="nav">
  						<li class="active">
    						<a href="/">PM2.5</a>
  						</li>
  						<li><a href="/map">Map</a></li>
  						<li><a href="/allcities">Cities</a></li>
                        <li><a href="/about">About</a></li>
					</ul>
				</div>
			</div>
			<div id="map"></div>
		</div>

		<script type="text/javascript">
			var aqiData = {max: 500, data : [{lat: 31.8100, lon: 119.97445, value: 93}, {lat: 32.202984, lon: 119.4238, value: 103}, {lat: 32.467540, lon: 119.92373, value: 118}, {lat: 33.623826, lon: 119.01599, value: 404}, {lat: 33.365002, lon: 120.168185, value: 77}, {lat: 33.975312, lon: 118.27579, value: 113}, {lat: 30.289371, lon: 120.15788, value: 134}, {lat: 29.872862, lon: 121.55177, value: 72}, {lat: 28.008407, lon: 120.69896, value: 130}, {lat: 30.004034, lon: 120.58545, value: 109}, {lat: 30.900193, lon: 120.08695, value: 86}, {lat: 30.760454, lon: 120.76158, value: 69}, {lat: 28.664143, lon: 121.420626, value: 97}, {lat: 29.985004, lon: 122.210061, value: 55}, {lat: 29.077806, lon: 119.650247, value: 124}, {lat: 28.96796, lon: 118.868365, value: 125}, {lat: 28.467213, lon: 119.926622, value: 92}, {lat: 31.822208, lon: 117.233462, value: 92}, {lat: 26.074117, lon: 119.304385, value: 62}, {lat: 24.480619, lon: 118.094652, value: 67}, {lat: 28.682818, lon: 115.852618, value: 119}, {lat: 36.651951, lon: 117.113986, value: 107}, {lat: 36.081405, lon: 120.398626, value: 500}]};

			// ???? until zhengzhou, not finished

			var map = L.map('map').setView([30.9043, 110.4677], 5);

			var baseLayer = L.tileLayer('http://{s}.tile.cloudmade.com/95eb5787c9eb436c9d7733c0135e1106/997/256/{z}/{x}/{y}.png', {attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://cloudmade.com">CloudMade</a>', maxZoom: 18}).addTo(map);

 			var heatmapLayer = L.TileLayer.heatMap({
 				//LatLng: [30.9043, 110.4677],
                radius: 20,
                opacity: 0.8,
                gradient: {
                    0.45: "rgb(0,0,255)",
                    0.55: "rgb(0,255,255)",
                    0.65: "rgb(0,255,0)",
                    0.95: "yellow",
                    1.0: "rgb(255,0,0)"
                }
            }).addTo(map);

            heatmapLayer.addData(aqiData.data);
 
            var overlayMaps = {
                'AQI': heatmapLayer
            };
 
            var controls = L.control.layers(null, overlayMaps, {collapsed: false});

            // get air quality data
 			$(function(){
    			$.ajax({
        		url: '/cities', //the URL to your node.js server that has data
        		dataType: 'json',
        		cache: false
    		}).done(function(data){
        		//"data" will be JSON. Do what you want with it. 
        		//alert(data);
    			}); 
			});

 			
 			//map.addLayer(heatmapLayer);

 			controls.addTo(map);

 			// make accessible for debugging
            //layer = heatmapLayer;
 			

 		</script>
		
		<script src="http://code.jquery.com/jquery.js"></script>
    	<script src="/bootstrap.min.js"></script>
	</body>
</html>
